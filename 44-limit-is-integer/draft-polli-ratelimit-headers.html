<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Rate-Limit Header Fields for HTTP</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Rate-limiting and quotas">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Current landscape of rate-limiting headers">
<link href="#rfc.section.1.2.1" rel="Chapter" title="1.2.1 Interoperability issues">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 This proposal">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Goals">
<link href="#rfc.section.1.5" rel="Chapter" title="1.5 Notational Conventions">
<link href="#rfc.section.2" rel="Chapter" title="2 Expressing rate-limit policies">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Time window">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Request quota">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Further considerations">
<link href="#rfc.section.3" rel="Chapter" title="3 Header Specifications">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 RateLimit-Limit">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 RateLimit-Remaining">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 RateLimit-Reset">
<link href="#rfc.section.4" rel="Chapter" title="4 Providing Rate-Limit headers">
<link href="#rfc.section.5" rel="Chapter" title="5 Receiving Rate-Limit headers">
<link href="#rfc.section.6" rel="Chapter" title="6 Examples">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Unparameterized responses">
<link href="#rfc.section.6.1.1" rel="Chapter" title="6.1.1 Throttling informations in responses">
<link href="#rfc.section.6.1.2" rel="Chapter" title="6.1.2 Use in conjunction with custom headers">
<link href="#rfc.section.6.1.3" rel="Chapter" title="6.1.3 Use for limiting concurrency">
<link href="#rfc.section.6.1.4" rel="Chapter" title="6.1.4 Use in throttled responses">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Parameterized responses">
<link href="#rfc.section.6.2.1" rel="Chapter" title="6.2.1 Throttling window specified via parameter">
<link href="#rfc.section.6.2.2" rel="Chapter" title="6.2.2 Dynamic limits with parameterized windows">
<link href="#rfc.section.6.2.3" rel="Chapter" title="6.2.3 Missing Remaining informations">
<link href="#rfc.section.6.2.4" rel="Chapter" title="6.2.4 Use with multiple windows">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Throttling does not prevent clients from issuing requests">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Information disclosure">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Remaining requests are not granted requests">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Reliability of RateLimit-Reset">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Resource exhaustion and clock skew">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 RateLimit-Limit Header Field Registration">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 RateLimit-Remaining Header Field Registration">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 RateLimit-Reset Header Field Registration">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.appendix.A" rel="Chapter" title="A Change Log">
<link href="#rfc.appendix.B" rel="Chapter" title="B Acknowledgements">
<link href="#rfc.appendix.C" rel="Chapter" title="C Ratelimit headers currently used on the web">
<link href="#rfc.appendix.D" rel="Chapter" title="D FAQ">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.22.2 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Polli, R." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-polli-ratelimit-headers-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-08-23" />
  <meta name="dct.abstract" content="This document defines the RateLimit-Limit, RateLimit-Remaining, RateLimit-Reset header fields for HTTP, thus allowing servers to publish current request quotas and clients to shape their request policy and avoid being throttled out." />
  <meta name="description" content="This document defines the RateLimit-Limit, RateLimit-Remaining, RateLimit-Reset header fields for HTTP, thus allowing servers to publish current request quotas and clients to shape their request policy and avoid being throttled out." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">R. Polli</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Team Digitale, Italian Government</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">August 23, 2019</td>
</tr>
<tr>
<td class="left">Expires: February 24, 2020</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Rate-Limit Header Fields for HTTP<br />
  <span class="filename">draft-polli-ratelimit-headers-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document defines the RateLimit-Limit, RateLimit-Remaining, RateLimit-Reset header fields for HTTP, thus allowing servers to publish current request quotas and clients to shape their request policy and avoid being throttled out.</p>
<h1><a>Note to Readers</a></h1>
<p><em>RFC EDITOR: please remove this section before publication</em></p>
<p>Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.</p>
<p>The source code and issues list for this draft can be found at <a href="https://github.com/ioggstream/draft-polli-ratelimit-headers">https://github.com/ioggstream/draft-polli-ratelimit-headers</a>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 24, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Rate-limiting and quotas</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Current landscape of rate-limiting headers</a>
</li>
<ul><li>1.2.1.   <a href="#rfc.section.1.2.1">Interoperability issues</a>
</li>
</ul><li>1.3.   <a href="#rfc.section.1.3">This proposal</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Goals</a>
</li>
<li>1.5.   <a href="#rfc.section.1.5">Notational Conventions</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Expressing rate-limit policies</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Time window</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Request quota</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Further considerations</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Header Specifications</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">RateLimit-Limit</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">RateLimit-Remaining</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">RateLimit-Reset</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Providing Rate-Limit headers</a>
</li>
<li>5.   <a href="#rfc.section.5">Receiving Rate-Limit headers</a>
</li>
<li>6.   <a href="#rfc.section.6">Examples</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Unparameterized responses</a>
</li>
<ul><li>6.1.1.   <a href="#rfc.section.6.1.1">Throttling informations in responses</a>
</li>
<li>6.1.2.   <a href="#rfc.section.6.1.2">Use in conjunction with custom headers</a>
</li>
<li>6.1.3.   <a href="#rfc.section.6.1.3">Use for limiting concurrency</a>
</li>
<li>6.1.4.   <a href="#rfc.section.6.1.4">Use in throttled responses</a>
</li>
</ul><li>6.2.   <a href="#rfc.section.6.2">Parameterized responses</a>
</li>
<ul><li>6.2.1.   <a href="#rfc.section.6.2.1">Throttling window specified via parameter</a>
</li>
<li>6.2.2.   <a href="#rfc.section.6.2.2">Dynamic limits with parameterized windows</a>
</li>
<li>6.2.3.   <a href="#rfc.section.6.2.3">Missing Remaining informations</a>
</li>
<li>6.2.4.   <a href="#rfc.section.6.2.4">Use with multiple windows</a>
</li>
</ul></ul><li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Throttling does not prevent clients from issuing requests</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Information disclosure</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Remaining requests are not granted requests</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Reliability of RateLimit-Reset</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Resource exhaustion and clock skew</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<ul><li>8.1.   <a href="#rfc.section.8.1">RateLimit-Limit Header Field Registration</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">RateLimit-Remaining Header Field Registration</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">RateLimit-Reset Header Field Registration</a>
</li>
</ul><li>9.   <a href="#rfc.references">References</a>
</li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Change Log</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.B">Acknowledgements</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.C">Ratelimit headers currently used on the web</a>
</li>
<li>Appendix D.   <a href="#rfc.appendix.D">FAQ</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The widespreading of HTTP as a distributed computation protocol requires an explicit way of communicating service status and usage quotas.</p>
<p id="rfc.section.1.p.2">This was partially addressed with the <samp>Retry-After</samp> header field defined in <a href="#RFC7231" class="xref">[RFC7231]</a> to be returned in <samp>429 Too Many Requests</samp> or <samp>503 Service Unavailable</samp> responses.</p>
<p id="rfc.section.1.p.3">Still, there is not a standard way to communicate service quotas so that the client can throttle its requests and prevent 4xx or 5xx responses.</p>
<h2 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#rate-limiting" id="rate-limiting">Rate-limiting and quotas</a>
</h2>
<p id="rfc.section.1.1.p.1">Servers use quota mechanisms to avoid systems overload, to ensure an equitable distribution of computational resources or to enforce other policies - eg. monetization.</p>
<p id="rfc.section.1.1.p.2">A basic quota mechanism limits the number of acceptable requests in a given time window, eg. 10 requests per second.</p>
<p id="rfc.section.1.1.p.3">When quota is exceeded, servers usually do not serve the request replying instead with a <samp>4xx</samp> HTTP status code (eg. 429 or 403) or adopt more aggressive policies like dropping connections.</p>
<p id="rfc.section.1.1.p.4">Quotas may be enforced on different basis (eg. per user, per IP, per geographic area, ..) and at different levels. For example, an user may be allowed to issue:</p>
<p></p>

<ul>
<li>10 requests per second;</li>
<li>limited to 60 request per minute;</li>
<li>limited to 1000 request per hour.</li>
</ul>
<p id="rfc.section.1.1.p.6">Moreover system metrics, statistics and heuristics can be used to implement more complex policies, where the number of acceptable request and the time window are computed dynamically.</p>
<h2 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> <a href="#current-landscape-of-rate-limiting-headers" id="current-landscape-of-rate-limiting-headers">Current landscape of rate-limiting headers</a>
</h2>
<p id="rfc.section.1.2.p.1">To help clients throttling their requests, servers may expose the counters used to evaluate quota policies via HTTP header fields.</p>
<p id="rfc.section.1.2.p.2">Those response headers may be added by HTTP intermediaries such as API gateways and reverse proxies.</p>
<p id="rfc.section.1.2.p.3">On the web we can find many different rate-limit headers, usually containing the number of allowed requests in a given time window, and when the window is reset.</p>
<p id="rfc.section.1.2.p.4">The common choice is to return three headers containing:</p>
<p></p>

<ul>
<li>the maximum number of allowed requests in the time window;</li>
<li>the number of remaining requests in the current window;</li>
<li>the time remaining in the current window expressed in seconds or as a timestamp;</li>
</ul>
<h3 id="rfc.section.1.2.1">
<a href="#rfc.section.1.2.1">1.2.1.</a> <a href="#interoperability-issues" id="interoperability-issues">Interoperability issues</a>
</h3>
<p id="rfc.section.1.2.1.p.1">A major interoperability issue in throttling is the lack of standard headers, because:</p>
<p></p>

<ul>
<li>each implementation associates different semantics to the same header field names;</li>
<li>header field names proliferates.</li>
</ul>
<p id="rfc.section.1.2.1.p.3">Client applications interfacing with different servers may thus need to process different headers, or the very same application interface that sits behind different reverse proxies may reply with different throttling headers.</p>
<h2 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#this-proposal" id="this-proposal">This proposal</a>
</h2>
<p id="rfc.section.1.3.p.1">This proposal defines syntax and semantics for the following header fields:</p>
<p></p>

<ul>
<li>
<samp>RateLimit-Limit</samp>: containing the requests quota in the time window;</li>
<li>
<samp>RateLimit-Reset</samp>: containing the time remaining in the current window, specified in seconds or as a timestamp;</li>
<li>
<samp>RateLimit-Remaining</samp>: containing the remaining requests quota in the current window;</li>
</ul>
<p id="rfc.section.1.3.p.3">The behavior of <samp>RateLimit-Reset</samp> is compatible with the one of <samp>Retry-After</samp>.</p>
<p id="rfc.section.1.3.p.4">The preferred syntax for <samp>RateLimit-Reset</samp> is the seconds notation respect to the timestamp one.</p>
<p id="rfc.section.1.3.p.5">The header definition allows to describe complex policies, including the ones using multiple and variable time windows or implementing concurrency limits.</p>
<h2 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> <a href="#goals" id="goals">Goals</a>
</h2>
<p id="rfc.section.1.4.p.1">The goals of this proposal are:</p>
<p></p>

<ol>
<li>Standardizing the names and semantic of rate-limit headers;</li>
<li>Improve resiliency of HTTP infrastructures simplifying the enforcement and the adoption of rate-limit headers;</li>
<li>Simplify API documentation avoiding expliciting rate-limit header fields semantic in documentation.</li>
</ol>
<p id="rfc.section.1.4.p.3">The goals do not include:</p>
<p></p>

<dl>
<dt>Authorization:</dt>
<dd style="margin-left: 8">The rate-limit headers described here are not meant to support authorization or other kinds of access controls.</dd>
<dt>Throttling scope:</dt>
<dd style="margin-left: 8">This specification does not cover the throttling scope, that may be the given resource-target, its parent path or the whole Origin <a href="#RFC6454" class="xref">[RFC6454]</a> section 7.</dd>
<dt>Response status code:</dt>
<dd style="margin-left: 8">This specification does not cover the response status code that may be used in throttled responses, nor ties the rate-limit headers to any HTTP status code. They may be returned in both Successful and non Successful responses.  Moreover this specification does not cover whether non Successful responses count on quota usage.</dd>
<dt>Throttling policy:</dt>
<dd style="margin-left: 8">This specification does not impose any throttling policy, but provides a mechanism for communicating quota metrics.  The values published in the headers, including the window size, can be statically or dynamically evaluated.  Moreover a different weight may be assigned to different requests.</dd>
<dt>Service Level Agreement:</dt>
<dd style="margin-left: 8">This specification allows a server to provide quota hints to the clients.  Those hints do not imply that respectful clients will not be throttled out or denied service under certain circumstances.</dd>
</dl>
<h2 id="rfc.section.1.5">
<a href="#rfc.section.1.5">1.5.</a> <a href="#notational-conventions" id="notational-conventions">Notational Conventions</a>
</h2>
<p id="rfc.section.1.5.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP 14 (<a href="#RFC2119" class="xref">[RFC2119]</a> and <a href="#RFC8174" class="xref">[RFC8174]</a>) when, and only when, they appear in all capitals, as shown here.</p>
<p id="rfc.section.1.5.p.2">This document uses the Augmented BNF defined in <a href="#RFC5234" class="xref">[RFC5234]</a> and updated by <a href="#RFC7405" class="xref">[RFC7405]</a> along with the &#8220;#rule&#8221; extension defined in Section 7 of <a href="#RFC7230" class="xref">[RFC7230]</a>.</p>
<p id="rfc.section.1.5.p.3">The term Origin is to be interpreted as described in <a href="#RFC6454" class="xref">[RFC6454]</a> section 7.</p>
<p id="rfc.section.1.5.p.4">The &#8220;delta-seconds&#8221; rule is defined in <a href="#RFC7234" class="xref">[RFC7234]</a> section 1.2.1.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#expressing-rate-limit-policies" id="expressing-rate-limit-policies">Expressing rate-limit policies</a>
</h1>
<h2 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#time-window" id="time-window">Time window</a>
</h2>
<p id="rfc.section.2.1.p.1">Rate limit policies limit the number of acceptable requests in a given time window.</p>
<p id="rfc.section.2.1.p.2">A time window is expressed in seconds, using the following syntax:</p>
<pre>
time-window = delta-seconds
</pre>
<p id="rfc.section.2.1.p.3">Subsecond precision is not supported.</p>
<h2 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#request-quota" id="request-quota">Request quota</a>
</h2>
<p id="rfc.section.2.2.p.1">The request-quota is a value associated to the maximum number of requests that the server is willing to accept from one or more clients on a given basis (originating IP, authenticated user, geographical, ..) during a time-window as defined in <a href="#time-window" class="xref">Section 2.1</a>.</p>
<p id="rfc.section.2.2.p.2">The <samp>request-quota</samp> syntax is the following:</p>
<pre>
request-quota = rlimit
rlimit = 1*DIGIT
</pre>
<p id="rfc.section.2.2.p.3">The <samp>request-quota</samp> SHOULD match the maximum number of acceptable requests.</p>
<p id="rfc.section.2.2.p.4">The <samp>request-quota</samp> MAY differ from the total number of acceptable requests when weight mechanisms or other server policies are implemented.</p>
<p id="rfc.section.2.2.p.5">Example: A server could</p>
<p></p>

<ul>
<li>count once requests like <samp>/books/{id}</samp>
</li>
<li>count twice search requests like <samp>/books?author=Camilleri</samp>
</li>
</ul>
<p id="rfc.section.2.2.p.7">so that we have the following counters</p>
<pre>
GET /books/123                  ; request-quota=4, remaining: 3, status=200
GET /books?author=Camilleri     ; request-quota=4, remaining: 1, status=200
GET /books?author=Eco           ; request-quota=4, remaining: 0, status=429
</pre>
<h2 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#further-considerations" id="further-considerations">Further considerations</a>
</h2>
<p id="rfc.section.2.3.p.1">This specification does not cover:</p>
<p></p>

<ul>
<li>the scope of the request throttling, that may be the given request-target, its parent path or the whole Origin;</li>
<li>whether non 2xx responses contribute or not to reach the quota limits;</li>
<li>which strategies to use to implement your quota policy.</li>
</ul>
<p id="rfc.section.2.3.p.3">&#8230;</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#header-specifications" id="header-specifications">Header Specifications</a>
</h1>
<p id="rfc.section.3.p.1">The following <samp>RateLimit</samp> response header fields are defined</p>
<h2 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#ratelimit-limit-header" id="ratelimit-limit-header">RateLimit-Limit</a>
</h2>
<p id="rfc.section.3.1.p.1">The <samp>RateLimit-Limit</samp> response header field indicates the <samp>request-quota</samp> associated to the client in the current <samp>time-window</samp>.</p>
<p id="rfc.section.3.1.p.2">If the client exceeds that limit, it MAY not be served.</p>
<p id="rfc.section.3.1.p.3">The header value is</p>
<pre>
RateLimit-Limit = expiring-limit [, 1#quota-policy ]
quota-policy = rlimit; "window" "=" time-window
expiring-limit = rlimit
</pre>
<p id="rfc.section.3.1.p.4">The <samp>expiring-limit</samp> value MUST be set to the <samp>request-quota</samp> that is closer to reach its limit.</p>
<pre>
RateLimit-Limit: 100
</pre>
<p id="rfc.section.3.1.p.5">A <samp>time-window</samp> associated to <samp>expiring-limit</samp> can be communicated via an optional <samp>quota-policy</samp> value, like shown in the following example</p>
<pre>
   RateLimit-Limit: 100, 100; window=10
</pre>
<p id="rfc.section.3.1.p.6">If the <samp>expiring-limit</samp> is not associated to a <samp>time-window</samp>, the <samp>time-window</samp> MUST either be:</p>
<p></p>

<ul>
<li>inferred by the value of <samp>RateLimit-Reset</samp> at the moment of the reset, or</li>
<li>communicated out-of-bound (eg. in the documentation).</li>
</ul>
<p id="rfc.section.3.1.p.8">Policies using multiple quota limits MAY be returned using multiple <samp>quota-policy</samp> items, like shown in the following example:</p>
<pre>
   RateLimit-Limit: 10, 10; window=1, 50; window=60, 1000; window=3600, 5000; window=86400
</pre>
<h2 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#ratelimit-remaining-header" id="ratelimit-remaining-header">RateLimit-Remaining</a>
</h2>
<p id="rfc.section.3.2.p.1">The <samp>RateLimit-Remaining</samp> response header field indicates the remaining <samp>request-quota</samp> <a href="#request-quota" class="xref">Section 2.2</a> associated to the client.</p>
<p id="rfc.section.3.2.p.2">The header syntax is:</p>
<pre>
RateLimit-Remaining = rlimit
rlimit = 1*DIGIT
</pre>
<p id="rfc.section.3.2.p.3">Clients MUST NOT assume that a positive <samp>RateLimit-Remaining</samp> value imply any guarantee of being served.  A low <samp>RateLimit-Remaining</samp> value is like a yellow traffic-light: the red light will arrive suddenly.</p>
<p id="rfc.section.3.2.p.4">One example of <samp>RateLimit-Remaining</samp> use is below.</p>
<pre>
   RateLimit-Remaining: 50
</pre>
<h2 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#ratelimit-reset-header" id="ratelimit-reset-header">RateLimit-Reset</a>
</h2>
<p id="rfc.section.3.3.p.1">The <samp>RateLimit-Reset</samp> response header field indicates either</p>
<p></p>

<ul>
<li>the number of seconds until the quota resets, or</li>
<li>the timestamp when the quota resets.</li>
</ul>
<p id="rfc.section.3.3.p.3">The header value is:</p>
<pre>
RateLimit-Reset = delta-seconds / HTTP-date
</pre>
<p id="rfc.section.3.3.p.4">The <samp>HTTP-date</samp> format is defined in <a href="#RFC7231" class="xref">[RFC7231]</a> appendix D.</p>
<p id="rfc.section.3.3.p.5">The <samp>RateLimit-Reset</samp> value:</p>
<p></p>

<ul>
<li>SHOULD use the <samp>delta-seconds</samp> format;</li>
<li>MAY use the <samp>HTTP-date</samp> format.</li>
</ul>
<p id="rfc.section.3.3.p.7">The <samp>HTTP-date</samp> format is NOT RECOMMENDED.</p>
<p id="rfc.section.3.3.p.8">The preferred format is the <samp>delta-seconds</samp> one, because:</p>
<p></p>

<ul>
<li>it does not rely on clock synchronization and is resilient to clock skew between client and server;</li>
<li>it does not require support for the <samp>obs-date</samp> format <a href="#RFC7231" class="xref">[RFC7231]</a> section 7.1.1.1 used by <samp>HTTP-date</samp>;</li>
<li>it mitigates the risk related to thundering herd when too many clients are serviced with the same timestamp.</li>
</ul>
<p id="rfc.section.3.3.p.10">Two examples of <samp>RateLimit-Reset</samp> use are below.</p>
<pre>
   RateLimit-Reset: 50                              ; preferred delta-seconds notation
   RateLimit-Reset: Tue, 15 Nov 1994 08:12:31 GMT   ; HTTP-date notation
</pre>
<p id="rfc.section.3.3.p.11">The client MUST NOT give for granted that all its <samp>request-quota</samp> will be restored after the moment referenced by <samp>RateLimit-Reset</samp>.  The server MAY arbitrarily alter the <samp>RateLimit-Reset</samp> value between subsequent requests eg. in case of resource saturation or to implement sliding window policies.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#providing-rate-limit-headers" id="providing-rate-limit-headers">Providing Rate-Limit headers</a>
</h1>
<p id="rfc.section.4.p.1">A server MAY use one or more <samp>RateLimit</samp> response header fields defined in this document to communicate its quota policies.</p>
<p id="rfc.section.4.p.2">The returned values apply to the metrics used to evaluate the quota policy respect to the current request and MAY not apply to subsequent requests.</p>
<p id="rfc.section.4.p.3">Example: a successful response with the following header fields</p>
<pre>
RateLimit-Limit: 10
RateLimit-Remaining: 1
RateLimit-Reset: 7
</pre>
<p id="rfc.section.4.p.4">does not imply that the next request will always be successful. Server metrics may be subject to other conditions like the one shown in the example from <a href="#request-quota" class="xref">Section 2.2</a>.</p>
<p id="rfc.section.4.p.5">A server MAY return <samp>RateLimit</samp> response header fields independently of the response status code.  This includes throttled responses.</p>
<p id="rfc.section.4.p.6">If a response contains both the <samp>Retry-After</samp> and the <samp>RateLimit-Reset</samp> header fields, the value of <samp>RateLimit-Reset</samp> MUST be consistent with the one of <samp>Retry-After</samp>.</p>
<p id="rfc.section.4.p.7">When using a quota policy involving more than one time-window, the server MUST reply with the <samp>RateLimit</samp> headers related to the window with the lower <samp>RateLimit-Remaining</samp> values.</p>
<p id="rfc.section.4.p.8">Under certain conditions, a server MAY artificially lower <samp>RateLimit</samp> headers values between subsequent requests, eg. to respond to Denial of Service attacks or in case of resource saturation.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#receiving-rate-limit-headers" id="receiving-rate-limit-headers">Receiving Rate-Limit headers</a>
</h1>
<p id="rfc.section.5.p.1">A client MUST process the received <samp>RateLimit</samp> headers.</p>
<p><samp>RateLimit</samp> headers with malformed values MAY be ignored.</p>
<p id="rfc.section.5.p.3">A client SHOULD NOT exceed the request-quota expressed in <samp>RateLimit-Remaining</samp> before the <samp>time-window</samp> expressed in <samp>RateLimit-Reset</samp>.</p>
<p id="rfc.section.5.p.4">A client MUST validate the values received in the <samp>RateLimit</samp> headers before using them and check if there are significant discrepancies with the expected ones.  This includes a <samp>RateLimit-Reset</samp> moment too far in the future or a <samp>request-quota</samp> too high.</p>
<p id="rfc.section.5.p.5">If a response contains both the <samp>RateLimit-Remaining</samp> and <samp>Retry-After</samp> header fields, the <samp>Retry-After</samp> header field MUST take precedence and the <samp>RateLimit-Remaining</samp> header field MAY be ignored.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#examples" id="examples">Examples</a>
</h1>
<h2 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#unparameterized-responses" id="unparameterized-responses">Unparameterized responses</a>
</h2>
<h3 id="rfc.section.6.1.1">
<a href="#rfc.section.6.1.1">6.1.1.</a> <a href="#throttling-informations-in-responses" id="throttling-informations-in-responses">Throttling informations in responses</a>
</h3>
<p id="rfc.section.6.1.1.p.1">The client is allowed to make 99 more requests in the next 50 seconds.  The <samp>time-window</samp> is communicated out-of-bound or inferred by the header values.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 100
  Ratelimit-Remaining: 99
  Ratelimit-Reset: 50

  {"hello": "world"}
</pre>
<h3 id="rfc.section.6.1.2">
<a href="#rfc.section.6.1.2">6.1.2.</a> <a href="#use-with-custom-headers" id="use-with-custom-headers">Use in conjunction with custom headers</a>
</h3>
<p id="rfc.section.6.1.2.p.1">The server uses two custom headers, namely <samp>acme-RateLimit-DayLimit</samp> and <samp>acme-RateLimit-HourLimit</samp> to expose the following policy:</p>
<p></p>

<ul>
<li>5000 daily request-quota;</li>
<li>1000 hourly request-quota.</li>
</ul>
<p id="rfc.section.6.1.2.p.3">The client consumed 4900 request-quota in the first 14 hours.</p>
<p id="rfc.section.6.1.2.p.4">Despite the next hourly limit of 1000 request-quota, the closest limit to reach is the daily one.</p>
<p id="rfc.section.6.1.2.p.5">The server then exposes the <samp>RateLimit-*</samp> headers to inform the client that:</p>
<p></p>

<ul>
<li>it has only 100 request left;</li>
<li>the window will reset in 10 hours.</li>
</ul>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  acme-RateLimit-DayLimit: 5000
  acme-RateLimit-HourLimit: 1000
  RateLimit-Limit: 5000
  RateLimit-Remaining: 100
  RateLimit-Reset: 36000

  {"hello": "world"}
</pre>
<h3 id="rfc.section.6.1.3">
<a href="#rfc.section.6.1.3">6.1.3.</a> <a href="#use-for-limiting-concurrency" id="use-for-limiting-concurrency">Use for limiting concurrency</a>
</h3>
<p id="rfc.section.6.1.3.p.1">Throttling headers may be used to limit concurrency, advertising limits that are lower than the usual ones in case of saturation, thus increasing availability.</p>
<p id="rfc.section.6.1.3.p.2">The server adopted a basic quota policy of 100 requests per minute, and in case of resource exhaustion adapts the returned values reducing both <samp>RateLimit-Limit</samp> and <samp>RateLimit-Remaining</samp>.</p>
<p id="rfc.section.6.1.3.p.3">After 2 seconds the server replied to 40 requests</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 100
  RateLimit-Remaining: 60
  RateLimit-Reset: 58

  {"elapsed": 2, "issued": 40}
</pre>
<p id="rfc.section.6.1.3.p.4">At the subsequent 41th request - due to resource exhaustion - the server advertises only <samp>RateLimit-Remaining: 20</samp>.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 100
  RateLimit-Remaining: 20
  RateLimit-Reset: 56

  {"elapsed": 4, "issued": 41}
</pre>
<h3 id="rfc.section.6.1.4">
<a href="#rfc.section.6.1.4">6.1.4.</a> <a href="#use-in-throttled-responses" id="use-in-throttled-responses">Use in throttled responses</a>
</h3>
<p id="rfc.section.6.1.4.p.1">A client exhausted its quota and the server throttles the request sending the <samp>Retry-After</samp> response header field.</p>
<p id="rfc.section.6.1.4.p.2">The values of <samp>Retry-After</samp> and <samp>RateLimit-Reset</samp> are consistent as they reference the same moment.</p>
<p id="rfc.section.6.1.4.p.3">The <samp>429 Too Many Requests</samp> HTTP status code is just used as an example.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 429 Too Many Requests
  Content-Type: application/json
  Date: Mon, 05 Aug 2019 09:27:00 GMT
  Retry-After: Mon, 05 Aug 2019 09:27:05 GMT
  RateLimit-Reset: 5
  RateLimit-Limit: 100
  Ratelimit-Remaining: 0

  {
    "title": "Too Many Requests",
    "status": 429,
    "detail": "You have exceeded your quota"
  }
</pre>
<h2 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#parameterized-responses" id="parameterized-responses">Parameterized responses</a>
</h2>
<h3 id="rfc.section.6.2.1">
<a href="#rfc.section.6.2.1">6.2.1.</a> <a href="#throttling-window-specified-via-parameter" id="throttling-window-specified-via-parameter">Throttling window specified via parameter</a>
</h3>
<p id="rfc.section.6.2.1.p.1">The client is allowed to make 99 more requests in the next 50 seconds.  The <samp>time-window</samp> is communicated by the <samp>window</samp> parameter, so we know the quota is 100 requests per minute.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 100, 100; window=60
  Ratelimit-Remaining: 99
  Ratelimit-Reset: 50

  {"hello": "world"}
</pre>
<h3 id="rfc.section.6.2.2">
<a href="#rfc.section.6.2.2">6.2.2.</a> <a href="#dynamic-limits-with-parameterized-windows" id="dynamic-limits-with-parameterized-windows">Dynamic limits with parameterized windows</a>
</h3>
<p id="rfc.section.6.2.2.p.1">The quota policy conveyed by <samp>RateLimit-Limit</samp> states that the server accepts 100 requests per minute.</p>
<p id="rfc.section.6.2.2.p.2">Due to resource exhaustion, the server artificially lowers the actual limits returned in the throttling headers.</p>
<p id="rfc.section.6.2.2.p.3">The current quota policy advertises then only 9 requests in the next 50 seconds.</p>
<p id="rfc.section.6.2.2.p.4">Note that the server could have lowered even the other values in <samp>RateLimit-Limit</samp>: this specification does not mandate any relation between the header values in subsequent responses.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 10, 100; window=60
  Ratelimit-Remaining: 9
  Ratelimit-Reset: 50

  {"hello": "world"}
</pre>
<h3 id="rfc.section.6.2.3">
<a href="#rfc.section.6.2.3">6.2.3.</a> <a href="#missing-remaining-informations" id="missing-remaining-informations">Missing Remaining informations</a>
</h3>
<p id="rfc.section.6.2.3.p.1">The server does not expose <samp>RateLimit-Remaining</samp> values, but resets the limit counter every second.</p>
<p id="rfc.section.6.2.3.p.2">It communicates to the client the limit of 10 request per second always returning the couple <samp>RateLimit-Limit</samp> and <samp>RateLimit-Reset</samp>.</p>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 10
  Ratelimit-Reset: 1

  {"first": "request"}
</pre>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 10
  Ratelimit-Reset: 1

  {"second": "request"}
</pre>
<h3 id="rfc.section.6.2.4">
<a href="#rfc.section.6.2.4">6.2.4.</a> <a href="#use-with-multiple-windows" id="use-with-multiple-windows">Use with multiple windows</a>
</h3>
<p id="rfc.section.6.2.4.p.1">This is a standardized way of describing the policy detailed in <a href="#use-with-custom-headers" class="xref">Section 6.1.2</a>:</p>
<p></p>

<ul>
<li>5000 daily request-quota;</li>
<li>1000 hourly request-quota.</li>
</ul>
<p id="rfc.section.6.2.4.p.3">The client consumed 4900 request-quota in the first 14 hours.</p>
<p id="rfc.section.6.2.4.p.4">Despite the next hourly limit of 1000 request-quota, the closest limit to reach is the daily one.</p>
<p id="rfc.section.6.2.4.p.5">The server then exposes the <samp>RateLimit</samp> headers to inform the client that:</p>
<p></p>

<ul>
<li>it has only 100 request left;</li>
<li>the window will reset in 10 hours;</li>
<li>the <samp>expiring-limit</samp> is 5000.</li>
</ul>
<pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  RateLimit-Limit: 5000, 1000; window=3600, 5000; window=86400
  RateLimit-Remaining: 100
  RateLimit-Reset: 36000

  {"hello": "world"}
</pre>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<h2 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#throttling-does-not-prevent-clients-from-issuing-requests" id="throttling-does-not-prevent-clients-from-issuing-requests">Throttling does not prevent clients from issuing requests</a>
</h2>
<p id="rfc.section.7.1.p.1">While this specification helps clients to avoid going over quota, it does not prevent them to make further requests.</p>
<p id="rfc.section.7.1.p.2">Servers should always implement their mechanisms to prevent resource exhaustion.</p>
<h2 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#information-disclosure" id="information-disclosure">Information disclosure</a>
</h2>
<p id="rfc.section.7.2.p.1">While this specification does not mandate whether non 2xx requests consume quota, if 401 and 403 responses count on quota a malicious client could get traffic informations of another user probing the endpoints.</p>
<h2 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#remaining-requests-are-not-granted-requests" id="remaining-requests-are-not-granted-requests">Remaining requests are not granted requests</a>
</h2>
<p id="rfc.section.7.3.p.1">The values passed in <samp>RateLimit-*</samp> headers are hints given from the server to the clients in order to avoid being throttled out.</p>
<p id="rfc.section.7.3.p.2">Clients MUST NOT give for granted the values returned in <samp>RateLimit-Remaining</samp>.</p>
<p id="rfc.section.7.3.p.3">In case of resource saturation, the server MAY artificially lower the returned values or not serve the request anyway.</p>
<h2 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#reliability-of-ratelimit-reset" id="reliability-of-ratelimit-reset">Reliability of RateLimit-Reset</a>
</h2>
<p id="rfc.section.7.4.p.1">Consider that <samp>request-quota</samp> may not be restored after the moment referenced by <samp>RateLimit-Reset</samp>, and the <samp>RateLimit-Reset</samp> value should not be considered fixed nor constant.</p>
<p id="rfc.section.7.4.p.2">Subsequent requests may return an increased value of <samp>RateLimit-Reset</samp> to limit concurrency or implement dynamic or adaptive throttling policies.</p>
<h2 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#resource-exhaustion-and-clock-skew" id="resource-exhaustion-and-clock-skew">Resource exhaustion and clock skew</a>
</h2>
<p id="rfc.section.7.5.p.1">When returning <samp>RateLimit-Reset</samp>, implementers must be aware that many throttled clients may come back at the very moment specified. For example, if the time-window is one hour and the returned value is something like</p>
<p><samp>RateLimit-Reset: Tue, 15 Nov 1994 08:00:00 GMT </samp></p>
<p id="rfc.section.7.5.p.3">there&#8217;s a high probability that all clients will show up at <samp>08:00:00</samp>.</p>
<p id="rfc.section.7.5.p.4">This could be mitigated adding some jitter to the header value.</p>
<p id="rfc.section.7.5.p.5">&#8230;</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<h2 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#ratelimit-limit-header-field-registration" id="ratelimit-limit-header-field-registration">RateLimit-Limit Header Field Registration</a>
</h2>
<p id="rfc.section.8.1.p.1">This section registers the <samp>RateLimit-Limit</samp> header field in the &#8220;Permanent Message Header Field Names&#8221; registry (<a href="#RFC3864" class="xref">[RFC3864]</a>).</p>
<p id="rfc.section.8.1.p.2">Header field name:  <samp>RateLimit-Limit</samp></p>
<p id="rfc.section.8.1.p.3">Applicable protocol:  http</p>
<p id="rfc.section.8.1.p.4">Status:  standard</p>
<p id="rfc.section.8.1.p.5">Author/Change controller:  IETF</p>
<p id="rfc.section.8.1.p.6">Specification document(s):  <a href="#ratelimit-limit-header" class="xref">Section 3.1</a> of this document</p>
<h2 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#ratelimit-remaining-header-field-registration" id="ratelimit-remaining-header-field-registration">RateLimit-Remaining Header Field Registration</a>
</h2>
<p id="rfc.section.8.2.p.1">This section registers the <samp>RateLimit-Remaining</samp> header field in the &#8220;Permanent Message Header Field Names&#8221; registry (<a href="#RFC3864" class="xref">[RFC3864]</a>).</p>
<p id="rfc.section.8.2.p.2">Header field name:  <samp>RateLimit-Remaining</samp></p>
<p id="rfc.section.8.2.p.3">Applicable protocol:  http</p>
<p id="rfc.section.8.2.p.4">Status:  standard</p>
<p id="rfc.section.8.2.p.5">Author/Change controller:  IETF</p>
<p id="rfc.section.8.2.p.6">Specification document(s):  <a href="#ratelimit-remaining-header" class="xref">Section 3.2</a> of this document</p>
<h2 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> <a href="#ratelimit-reset-header-field-registration" id="ratelimit-reset-header-field-registration">RateLimit-Reset Header Field Registration</a>
</h2>
<p id="rfc.section.8.3.p.1">This section registers the <samp>RateLimit-Reset</samp> header field in the &#8220;Permanent Message Header Field Names&#8221; registry (<a href="#RFC3864" class="xref">[RFC3864]</a>).</p>
<p id="rfc.section.8.3.p.2">Header field name:  <samp>RateLimit-Reset</samp></p>
<p id="rfc.section.8.3.p.3">Applicable protocol:  http</p>
<p id="rfc.section.8.3.p.4">Status:  standard</p>
<p id="rfc.section.8.3.p.5">Author/Change controller:  IETF</p>
<p id="rfc.section.8.3.p.6">Specification document(s):  <a href="#ratelimit-reset-header" class="xref">Section 3.3</a> of this document</p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h2 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3864">[RFC3864]</b></td>
<td class="top">
<a>Klyne, G.</a>, <a>Nottingham, M.</a> and <a>J. Mogul</a>, "<a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>", BCP 90, RFC 3864, DOI 10.17487/RFC3864, September 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, DOI 10.17487/RFC5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6454">[RFC6454]</b></td>
<td class="top">
<a>Barth, A.</a>, "<a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>", RFC 6454, DOI 10.17487/RFC6454, December 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7230">[RFC7230]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>", RFC 7230, DOI 10.17487/RFC7230, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7231">[RFC7231]</b></td>
<td class="top">
<a>Fielding, R.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>", RFC 7231, DOI 10.17487/RFC7231, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7234">[RFC7234]</b></td>
<td class="top">
<a>Fielding, R.</a>, <a>Nottingham, M.</a> and <a>J. Reschke</a>, "<a href="https://tools.ietf.org/html/rfc7234">Hypertext Transfer Protocol (HTTP/1.1): Caching</a>", RFC 7234, DOI 10.17487/RFC7234, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7405">[RFC7405]</b></td>
<td class="top">
<a>Kyzivat, P.</a>, "<a href="https://tools.ietf.org/html/rfc7405">Case-Sensitive String Support in ABNF</a>", RFC 7405, DOI 10.17487/RFC7405, December 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="UNIX">[UNIX]</b></td>
<td class="top">
<a>The Open Group, .</a>, "<a>The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98</a>", February 1997.</td>
</tr>
</tbody></table>
<h2 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h2>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3339">[RFC3339]</b></td>
<td class="top">
<a>Klyne, G.</a> and <a>C. Newman</a>, "<a href="https://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>", RFC 3339, DOI 10.17487/RFC3339, July 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6585">[RFC6585]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>R. Fielding</a>, "<a href="https://tools.ietf.org/html/rfc6585">Additional HTTP Status Codes</a>", RFC 6585, DOI 10.17487/RFC6585, April 2012.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.A">
<a href="#rfc.appendix.A">Appendix A.</a> <a href="#change-log" id="change-log">Change Log</a>
</h1>
<p id="rfc.section.A.p.1">RFC EDITOR PLEASE DELETE THIS SECTION.</p>
<h1 id="rfc.appendix.B">
<a href="#rfc.appendix.B">Appendix B.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.B.p.1">Thanks to Willi Schoenborn, Alessandro Ranellucci, Erik Wilde and Mark Nottingham for being the initial contributors of this specifications.</p>
<h1 id="rfc.appendix.C">
<a href="#rfc.appendix.C">Appendix C.</a> <a href="#ratelimit-headers-currently-used-on-the-web" id="ratelimit-headers-currently-used-on-the-web">Ratelimit headers currently used on the web</a>
</h1>
<p id="rfc.section.C.p.1">RFC EDITOR PLEASE DELETE THIS SECTION.</p>
<p id="rfc.section.C.p.2">Commonly used header field names are:</p>
<p></p>

<ul>
<li>
<samp>X-RateLimit-Limit</samp>, <samp>X-RateLimit-Remaining</samp>, <samp>X-RateLimit-Reset</samp>;</li>
<li>
<samp>X-Rate-Limit-Limit</samp>, <samp>X-Rate-Limit-Remaining</samp>, <samp>X-Rate-Limit-Reset</samp>.</li>
</ul>
<p id="rfc.section.C.p.4">There are variants too, where the window is specified in the header field name, eg:</p>
<p></p>

<ul>
<li>
<samp>x-ratelimit-limit-minute</samp>, <samp>x-ratelimit-limit-hour</samp>, <samp>x-ratelimit-limit-day</samp>
</li>
<li>
<samp>x-ratelimit-remaining-minute</samp>, <samp>x-ratelimit-remaining-hour</samp>, <samp>x-ratelimit-remaining-day</samp>
</li>
</ul>
<p id="rfc.section.C.p.6">Here are some interoperability issues:</p>
<p></p>

<ul>
<li>
<samp>X-RateLimit-Remaining</samp> references different values, depending on the implementation:  <ul>
<li>seconds remaining to the window expiration</li>
<li>milliseconds remaining to the window expiration</li>
<li>seconds since UTC, in UNIX Timestamp</li>
<li>a datetime, either <samp>HTTP-date</samp> <a href="#RFC7231" class="xref">[RFC7231]</a> or <a href="#RFC3339" class="xref">[RFC3339]</a>
</li>
</ul>
</li>
<li>different headers, with the same semantic, are used by different implementers:  <ul>
<li>X-RateLimit-Limit and X-Rate-Limit-Limit</li>
<li>X-RateLimit-Remaining and X-Rate-Limit-Remaining</li>
<li>X-RateLimit-Reset and X-Rate-Limit-Reset</li>
</ul>
</li>
</ul>
<h1 id="rfc.appendix.D">
<a href="#rfc.appendix.D">Appendix D.</a> <a href="#faq" id="faq">FAQ</a>
</h1>
<p></p>

<ol>
<li>Why defining standard headers for throttling?  <br><br> To simplify enforcement of throttling policies.</li>
<li>Why using delta-seconds instead of UNIX Timestamp? Why HTTP-date is NOT RECOMMENDED? Why not using subsecond precision?  <br><br> Using delta-seconds permits to align with <samp>Retry-After</samp>, which is returned in similar contexts, eg on 429 responses.  <br><br> delta-seconds as defined in <a href="#RFC7234" class="xref">[RFC7234]</a> section 1.2.1 clarifies some parsing rules too.  <br><br> As explained in <a href="#RFC7231" class="xref">[RFC7231]</a> section 4.1.1.1 using <samp>HTTP-date</samp> requires a clock synchronization protocol. This may be problematic (eg. clock skew, failure of hardcoded clock synchronization servers, IoT devices, ..).  See <a href="https://community.ntppool.org/t/another-ntp-client-failure-story/1014/">Another NTP client failure story</a>  <br><br> We did not use subsecond precision because almost all rate-limit headers implementations do not use it.  Conveyed values are subject to response-time latency. A brief discussion on the subject is on the <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/2019JulSep/0202.html">httpwg ml</a>
</li>
<li>Why don&#8217;t pass the trottling scope as a parameter?  <br><br> I&#8217;m open to suggestions. File an issue if you think it&#8217;s worth ;).</li>
<li>Do <samp>RateLimit-Limit</samp> and <samp>RateLimit-Remaining</samp> represent the exact number of requests I can issue?  <br><br> No, unless the server explicits that in some way.  As servers may weight requests, this to not impose a 1-1 mapping between the &#8220;requests quota&#8221; and the &#8220;maximum number of requests&#8221;.  See the example in <a href="#request-quota" class="xref">Section 2.2</a>
</li>
<li>Do we want to tie this spec to RFC 6585?  <br><br> <a href="#RFC6585" class="xref">[RFC6585]</a> defines the <samp>429</samp> status code. We could dis-entangle this spec from that one and avoiding any suggestion on which HTTP status code to use in over-quota request.</li>
<li>Why not support multiple quota remaining?  <br><br> While this might be of some value, my experience suggests that overly-complex quota implementations results in lower effectiveness of this policy. This spec allows the client to easily focusing on RateLimit-Remaining and RateLimit-Reset.</li>
<li>Can I use RateLimit-* in throttled responses (eg together with 429)? Yes, you can.</li>
<li>Shouldn&#8217;t I limit concurrency instead of request rate?  <br><br> You can do both. The goal of this spec is to provide guidance for clients in shaping their requests without being throttled out.  <br><br> Usually, limiting concurrency results in unserviced client requests, which is something you may want to avoid.  <br><br> A standard way to limit concurrency is to return 503 + Retry-After in case of resource saturation (eg. thrashing, connection queues too long, Service Level Objectives not meet, ..).  <br><br> Dynamically lowering the values returned by the rate-limit headers, and returning retry-after along with them can improve availability.  <br><br> Saturation conditions can be either dynamic or static: all this is out of the scope for the current document.</li>
<li>Do a positive value of <samp>RateLimit-Remaining</samp> imply any service guarantee for my future requests to be served?  <br><br> No. The returned values were used to decide whether to serve or not <em>the current request</em> and so they do not imply any guarantee that future requests will be successful.  <br><br> Instead they provide informations that should be used to understand when future requests have an high probablility of not being successful. A low value for <samp>RateLimit-Remaining</samp> should be intepreted as a yellow traffic-light instead of a green one.  <br><br> Servers implementing sliding window techniques or concurrency limits moreover may arbitrarily lower the internal counters used to compute the remaining quota values.</li>
</ol>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Roberto Polli</span> 
	  <span class="n hidden">
		<span class="family-name">Polli</span>
	  </span>
	</span>
	<span class="org vcardline">Team Digitale, Italian Government</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:robipolli@gmail.com">robipolli@gmail.com</a></span>

  </address>
</div>

</body>
</html>

